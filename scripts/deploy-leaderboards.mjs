import { ethers } from 'ethers';
import { readFileSync } from 'fs';

const PRIVATE_KEY = process.env.PRIVATE_KEY;

if (!PRIVATE_KEY) {
  console.error('‚ùå Error: PRIVATE_KEY environment variable is required');
  console.error('Usage: PRIVATE_KEY=your_key_here node scripts/deploy-leaderboards.mjs');
  process.exit(1);
}
const RPC_URL = 'https://sepolia.base.org';

// Contract artifacts (compiled bytecode)
const bytecode = '0x608060405234801561000f575f5ffd5b506040516126e23803806126e2833981810160405281019061003191906102dd565b335f73ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff16036100a2575f6040517f1e4fbdf70000000000000000000000000000000000000000000000000000000081526004016100999190610363565b60405180910390fd5b6100b1816100cf60201b60201c565b506001808190555080600590816100c8919061058c565b505061065b565b5f5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050815f5f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a35050565b5f604051905090565b5f5ffd5b5f5ffd5b5f5ffd5b5f5ffd5b5f601f19601f8301169050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52604160045260245ffd5b6101ef826101a9565b810181811067ffffffffffffffff8211171561020e5761020d6101b9565b5b80604052505050565b5f610220610190565b905061022c82826101e6565b919050565b5f67ffffffffffffffff82111561024b5761024a6101b9565b5b610254826101a9565b9050602081019050919050565b8281835e5f83830152505050565b5f61028161027c84610231565b610217565b90508281526020810184848401111561029d5761029c6101a5565b5b6102a8848285610261565b509392505050565b5f82601f8301126102c4576102c36101a1565b5b81516102d484826020860161026f565b91505092915050565b5f602082840312156102f2576102f1610199565b5b5f82015167ffffffffffffffff81111561030f5761030e61019d565b5b61031b848285016102b0565b91505092915050565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f61034d82610324565b9050919050565b61035d81610343565b82525050565b5f6020820190506103765f830184610354565b92915050565b5f81519050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52602260045260245ffd5b5f60028204905060018216806103ca57607f821691505b6020821081036103dd576103dc610386565b5b50919050565b5f819050815f5260205f209050919050565b5f6020601f8301049050919050565b5f82821b905092915050565b5f6008830261043f7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff82610404565b6104498683610404565b95508019841693508086168417925050509392505050565b5f819050919050565b5f819050919050565b5f61048d61048861048384610461565b61046a565b610461565b9050919050565b5f819050919050565b6104a683610473565b6104ba6104b282610494565b848454610410565b825550505050565b5f5f905090565b6104d16104c2565b6104dc81848461049d565b505050565b5b818110156104ff576104f45f826104c9565b6001810190506104e2565b5050565b601f82111561054457610515816103e3565b61051e846103f5565b8101602085101561052d578190505b610541610539856103f5565b8301826104e1565b50505b505050565b5f82821c905092915050565b5f6105645f1984600802610549565b1980831691505092915050565b5f61057c8383610555565b9150826002028217905092915050565b6105958261037c565b67ffffffffffffffff8111156105ae576105ad6101b9565b5b6105b882546103b3565b6105c3828285610503565b5f60209050601f8311600181146105f4575f84156105e2578287015190505b6105ec8582610571565b865550610653565b601f198416610602866103e3565b5f5b8281101561062957848901518255600182019150602085019450602081019050610604565b868310156106465784890151610642601f891682610555565b8355505b6001600288020188555050505b505050505050565b61207a806106685f395ff3fe608060405234801561000f575f5ffd5b506004361061011f575f3560e01c80638da5cb5b116100ab578063c59d48471161006f578063c59d4847146102bf578063cc3d967b146102e1578063daae940314610316578063de75aa6c14610332578063f2fde38b146103625761011f565b80638da5cb5b14610205578063a26dbf2614610223578063a395401614610241578063b2d1573f1461025f578063b34e0c471461028f5761011f565b80634ba3f857116100f25780634ba3f857146101995780635c975abb146101c9578063715018a6146101e7578063788de127146101f15780638456cb59146101fb5761011f565b80630e666e49146101235780631b3e4db114610153578063306b96b0146101715780633f4ba83a1461018f575b5f5ffd5b61013d60048036038101906101389190611747565b61037e565b60405161014a919061178c565b60405180910390f35b61015b6103c9565b60405161016891906117bd565b60405180910390f35b6101796103d5565b6040516101869190611846565b60405180910390f35b610197610461565b005b6101b360048036038101906101ae9190611890565b610473565b6040516101c091906119fa565b60405180910390f35b6101d16106a0565b6040516101de919061178c565b60405180910390f35b6101ef6106b5565b005b6101f96106c8565b005b61020361077c565b005b61020d61078e565b60405161021a9190611a29565b60405180910390f35b61022b6107b5565b60405161023891906117bd565b60405180910390f35b6102496107bb565b60405161025691906117bd565b60405180910390f35b61027960048036038101906102749190611747565b6107c1565b60405161028691906117bd565b60405180910390f35b6102a960048036038101906102a49190611747565b610807565b6040516102b69190611aa8565b60405180910390f35b6102c761088f565b6040516102d8959493929190611ac1565b60405180910390f35b6102fb60048036038101906102f69190611747565b6109fb565b60405161030d96959493929190611b12565b60405180910390f35b610330600480360381019061032b9190611baa565b610ae9565b005b61034c60048036038101906103479190611be8565b610d7a565b60405161035991906119fa565b60405180910390f35b61037c60048036038101906103779190611747565b610f34565b005b5f5f60025f8473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f2060020154119050919050565b5f600380549050905090565b600580546103e290611c40565b80601f016020809104026020016040519081016040528092919081815260200182805461040e90611c40565b80156104595780601f1061043057610100808354040283529160200191610459565b820191905f5260205f20905b81548152906001019060200180831161043c57829003601f168201915b505050505081565b610469610fb8565b61047161103f565b565b606060038054905083106104bc576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016104b390611cba565b60405180910390fd5b5f82846104c99190611d05565b90506003805490508111156104e15760038054905090505b5f84826104ee9190611d38565b90505f8167ffffffffffffffff81111561050b5761050a611d6b565b5b60405190808252806020026020018201604052801561054457816020015b610531611646565b8152602001906001900390816105295790505b5090505f5f90505b82811015610693575f600382896105639190611d05565b8154811061057457610573611d98565b5b905f5260205f20015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690505f60025f8373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f206040518060a00160405290815f820154815260200160018201548152602001600282015481526020016003820154815260200160048201548152505090506040518060a001604052808373ffffffffffffffffffffffffffffffffffffffff168152602001825f015181526020018260200151815260200182604001518152602001826060015181525084848151811061067957610678611d98565b5b60200260200101819052505050808060010191505061054c565b5080935050505092915050565b5f5f60149054906101000a900460ff16905090565b6106bd610fb8565b6106c65f6110a0565b565b6106d0610fb8565b60035f6106dd9190611686565b5f5f90505b600380549050811015610779575f60045f6003848154811061070757610706611d98565b5b905f5260205f20015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f208190555080806001019150506106e2565b50565b610784610fb8565b61078c611161565b565b5f5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b60065481565b60075481565b5f60045f8373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f20549050919050565b61080f6116a4565b60025f8373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f206040518060a00160405290815f82015481526020016001820154815260200160028201548152602001600382015481526020016004820154815250509050919050565b5f5f5f5f5f600654945060075493505f60065411156109f4575f5f90505f5f90505b6003805490508110156109535760025f600383815481106108d5576108d4611d98565b5b905f5260205f20015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f0154826109449190611d05565b915080806001019150506108b1565b50600654816109629190611df2565b93505f60038054905011156109f25760035f8154811061098557610984611d98565b5b905f5260205f20015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16925060025f8473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f015491505b505b9091929394565b5f5f5f5f5f5f5f60025f8973ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f206040518060a00160405290815f82015481526020016001820154815260200160028201548152602001600382015481526020016004820154815250509050805f01518160200151826040015160045f8c73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f2054846060015185608001519650965096509650965096505091939550919395565b610af16111c3565b610af9611204565b5f73ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1603610b67576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610b5e90611e6c565b60405180910390fd5b5f8163ffffffff1611610baf576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610ba690611ed4565b60405180910390fd5b8173ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614610c1d576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610c1490611f3c565b60405180910390fd5b5f60025f8473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f2090505f5f82600201541490508263ffffffff16825f015f828254610c7f9190611d05565b92505081905550816002015f815480929190610c9a90611f5a565b91905055504282600301819055508015610ccf5742826004018190555060065f815480929190610cc990611f5a565b91905055505b81600101548363ffffffff161115610cf1578263ffffffff1682600101819055505b60075f815480929190610d0390611f5a565b9190505550610d118461124a565b8373ffffffffffffffffffffffffffffffffffffffff167f77bc55c7c42e8f06f1eb2daaab09860f6eee48cbd241bee1b2371c8c7280159384845f0154856001015442604051610d649493929190611fda565b60405180910390a25050610d766115f6565b5050565b6060600380549050821115610d925760038054905091505b5f8267ffffffffffffffff811115610dad57610dac611d6b565b5b604051908082528060200260200182016040528015610de657816020015b610dd3611646565b815260200190600190039081610dcb5790505b5090505f5f90505b83811015610f2a575f60038281548110610e0b57610e0a611d98565b5b905f5260205f20015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690505f60025f8373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f206040518060a00160405290815f820154815260200160018201548152602001600282015481526020016003820154815260200160048201548152505090506040518060a001604052808373ffffffffffffffffffffffffffffffffffffffff168152602001825f0151815260200182602001518152602001826040015181526020018260600151815250848481518110610f1057610f0f611d98565b5b602002602001018190525050508080600101915050610dee565b5080915050919050565b610f3c610fb8565b5f73ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1603610fac575f6040517f1e4fbdf7000000000000000000000000000000000000000000000000000000008152600401610fa39190611a29565b60405180910390fd5b610fb5816110a0565b50565b610fc06115ff565b73ffffffffffffffffffffffffffffffffffffffff16610fde61078e565b73ffffffffffffffffffffffffffffffffffffffff161461103d576110016115ff565b6040517f118cdaa70000000000000000000000000000000000000000000000000000000081526004016110349190611a29565b60405180910390fd5b565b611047611606565b5f5f60146101000a81548160ff0219169083151502179055507f5db9ee0a495bf2e6ff9c91a7834c1ba4fdd244a5e8aa4e537bd38aeae4b073aa6110896115ff565b6040516110969190611a29565b60405180910390a1565b5f5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050815f5f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a35050565b6111696111c3565b60015f60146101000a81548160ff0219169083151502179055507f62e78cea01bee320cd4e420270b5ea74000d11b0c9f74754ebdbfc544b05a2586111ac6115ff565b6040516111b99190611a29565b60405180910390a1565b6111cb6106a0565b15611202576040517fd93c066500000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b565b600260015403611240576040517f3ee5aeb500000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b6002600181905550565b5f60045f8373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205490505f60025f8473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f015490505f820361138557600383908060018154018082558091505060019003905f5260205f20015f9091909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060038054905060045f8573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f208190555060038054905091505b5f8290505b600181111561159a575f60036002836113a39190611d38565b815481106113b4576113b3611d98565b5b905f5260205f20015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690508260025f8373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f01541061142a575061159a565b80600360018461143a9190611d38565b8154811061144b5761144a611d98565b5b905f5260205f20015f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508460036002846114a09190611d38565b815481106114b1576114b0611d98565b5b905f5260205f20015f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508160045f8373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f20819055506001826115459190611d38565b60045f8773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f208190555081806115919061201d565b9250505061138a565b8281146115f0578373ffffffffffffffffffffffffffffffffffffffff167f24e225604268d6416871b32db1be8e49f497caf8360393b31d71a34a4ce26693826040516115e791906117bd565b60405180910390a25b50505050565b60018081905550565b5f33905090565b61160e6106a0565b611644576040517f8dfc202b00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b565b6040518060a001604052805f73ffffffffffffffffffffffffffffffffffffffff1681526020015f81526020015f81526020015f81526020015f81525090565b5080545f8255905f5260205f20908101906116a191906116ce565b50565b6040518060a001604052805f81526020015f81526020015f81526020015f81526020015f81525090565b5b808211156116e5575f815f9055506001016116cf565b5090565b5f5ffd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f611716826116ed565b9050919050565b6117268161170c565b8114611730575f5ffd5b50565b5f813590506117418161171d565b92915050565b5f6020828403121561175c5761175b6116e9565b5b5f61176984828501611733565b91505092915050565b5f8115159050919050565b61178681611772565b82525050565b5f60208201905061179f5f83018461177d565b92915050565b5f819050919050565b6117b7816117a5565b82525050565b5f6020820190506117d05f8301846117ae565b92915050565b5f81519050919050565b5f82825260208201905092915050565b8281835e5f83830152505050565b5f601f19601f8301169050919050565b5f611818826117d6565b61182281856117e0565b93506118328185602086016117f0565b61183b816117fe565b840191505092915050565b5f6020820190508181035f83015261185e818461180e565b905092915050565b61186f816117a5565b8114611879575f5ffd5b50565b5f8135905061188a81611866565b92915050565b5f5f604083850312156118a6576118a56116e9565b5b5f6118b38582860161187c565b92505060206118c48582860161187c565b9150509250929050565b5f81519050919050565b5f82825260208201905092915050565b5f819050602082019050919050565b6119008161170c565b82525050565b61190f816117a5565b82525050565b60a082015f8201516119295f8501826118f7565b50602082015161193c6020850182611906565b50604082015161194f6040850182611906565b5060608201516119626060850182611906565b5060808201516119756080850182611906565b50505050565b5f6119868383611915565b60a08301905092915050565b5f602082019050919050565b5f6119a8826118ce565b6119b281856118d8565b93506119bd836118e8565b805f5b838110156119ed5781516119d4888261197b565b97506119df83611992565b9250506001810190506119c0565b5085935050505092915050565b5f6020820190508181035f830152611a12818461199e565b905092915050565b611a238161170c565b82525050565b5f602082019050611a3c5f830184611a1a565b92915050565b60a082015f820151611a565f850182611906565b506020820151611a696020850182611906565b506040820151611a7c6040850182611906565b506060820151611a8f6060850182611906565b506080820151611aa26080850182611906565b50505050565b5f60a082019050611abb5f830184611a42565b92915050565b5f60a082019050611ad45f8301886117ae565b611ae160208301876117ae565b611aee60408301866117ae565b611afb6060830185611a1a565b611b0860808301846117ae565b9695505050505050565b5f60c082019050611b255f8301896117ae565b611b3260208301886117ae565b611b3f60408301876117ae565b611b4c60608301866117ae565b611b5960808301856117ae565b611b6660a08301846117ae565b979650505050505050565b5f63ffffffff82169050919050565b611b8981611b71565b8114611b93575f5ffd5b50565b5f81359050611ba481611b80565b92915050565b5f5f60408385031215611bc057611bbf6116e9565b5b5f611bcd85828601611733565b9250506020611bde85828601611b96565b9150509250929050565b5f60208284031215611bfd57611bfc6116e9565b5b5f611c0a8482850161187c565b91505092915050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52602260045260245ffd5b5f6002820490506001821680611c5757607f821691505b602082108103611c6a57611c69611c13565b5b50919050565b7f4f6666736574206f7574206f6620626f756e64730000000000000000000000005f82015250565b5f611ca46014836117e0565b9150611caf82611c70565b602082019050919050565b5f6020820190508181035f830152611cd181611c98565b9050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffd5b5f611d0f826117a5565b9150611d1a836117a5565b9250828201905080821115611d3257611d31611cd8565b5b92915050565b5f611d42826117a5565b9150611d4d836117a5565b9250828203905081811115611d6557611d64611cd8565b5b92915050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52604160045260245ffd5b7f4e487b71000000000000000000000000000000000000000000000000000000005f52603260045260245ffd5b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601260045260245ffd5b5f611dfc826117a5565b9150611e07836117a5565b925082611e1757611e16611dc5565b5b828204905092915050565b7f496e76616c6964207573657220616464726573730000000000000000000000005f82015250565b5f611e566014836117e0565b9150611e6182611e22565b602082019050919050565b5f6020820190508181035f830152611e8381611e4a565b9050919050565b7f53636f7265206d75737420626520706f736974697665000000000000000000005f82015250565b5f611ebe6016836117e0565b9150611ec982611e8a565b602082019050919050565b5f6020820190508181035f830152611eeb81611eb2565b9050919050565b7f43616e206f6e6c79207375626d697420796f7572206f776e2073636f726500005f82015250565b5f611f26601e836117e0565b9150611f3182611ef2565b602082019050919050565b5f6020820190508181035f830152611f5381611f1a565b9050919050565b5f611f64826117a5565b91507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff8203611f9657611f95611cd8565b5b600182019050919050565b5f819050919050565b5f611fc4611fbf611fba84611b71565b611fa1565b6117a5565b9050919050565b611fd481611faa565b82525050565b5f608082019050611fed5f830187611fcb565b611ffa60208301866117ae565b61200760408301856117ae565b61201460608301846117ae565b95945050505050565b5f612027826117a5565b91505f820361203957612038611cd8565b5b60018203905091905056fea26469706673582212205582eb48b9df8dd3e86ef587c5e846e634aad4a6221659c48f9a34dc9570863264736f6c634300081b0033';

const abi = ['constructor(string _exerciseName)'];

async function deploy() {
  console.log('üöÄ Deploying Public ExerciseLeaderboard Contracts to Base Sepolia...\n');

  const provider = new ethers.JsonRpcProvider(RPC_URL);
  const wallet = new ethers.Wallet(PRIVATE_KEY, provider);

  console.log(`Deployer: ${wallet.address}`);
  const balance = await provider.getBalance(wallet.address);
  console.log(`Balance: ${ethers.formatEther(balance)} ETH\n`);

  // Deploy Pullups
  console.log('üìù Deploying Pullups Leaderboard...');
  const pullupsFactory = new ethers.ContractFactory(abi, bytecode, wallet);
  const pullups = await pullupsFactory.deploy('Pull-ups');
  await pullups.waitForDeployment();
  const pullupsAddress = await pullups.getAddress();
  console.log(`‚úÖ Pullups Leaderboard deployed: ${pullupsAddress}\n`);

  // Deploy Jumps
  console.log('üìù Deploying Jumps Leaderboard...');
  const jumpsFactory = new ethers.ContractFactory(abi, bytecode, wallet);
  const jumps = await jumpsFactory.deploy('Jumps');
  await jumps.waitForDeployment();
  const jumpsAddress = await jumps.getAddress();
  console.log(`‚úÖ Jumps Leaderboard deployed: ${jumpsAddress}\n`);

  console.log('‚úÖ Deployment Complete!\n');
  console.log('Contract Addresses:');
  console.log('===================');
  console.log(`Pullups: ${pullupsAddress}`);
  console.log(`Jumps:   ${jumpsAddress}`);
  console.log('\nUpdate src/lib/contracts.ts with these addresses');
}

deploy().catch(console.error);
